{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\n\nexport function displayImages(images, gallery) {\n  if (images.length === 0) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  } else {\n    const imageElements = images.map(image => {\n      const imgElement = document.createElement('img');\n      imgElement.src = image.webformatURL;\n      imgElement.alt = image.tags;\n      imgElement.dataset.largeImage = image.largeImageURL;\n      imgElement.dataset.likes = image.likes;\n      imgElement.dataset.views = image.views;\n      imgElement.dataset.comments = image.comments;\n      imgElement.dataset.downloads = image.downloads;\n\n      imgElement.classList.add('simplelightbox');\n\n      const card = document.createElement('div');\n      card.className = 'card';\n      card.appendChild(imgElement);\n      const info = document.createElement('div');\n      info.className = 'info';\n      info.innerHTML = `\n        <p>Likes: ${image.likes}</p>\n        <p>Views: ${image.views}</p>\n        <p>Comments: ${image.comments}</p>\n        <p>Downloads: ${image.downloads}</p>\n      `;\n      card.appendChild(info);\n      return card;\n    });\n\n    gallery.append(...imageElements);\n  }\n}\n","\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport { displayImages } from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst loader = document.querySelector('.loader');\nconst gallery = document.getElementById('gallery');\nconst loadMoreBtn = document.getElementById('load-more-btn');\n\nlet currentPage = 1;\nlet searchTerm = '';\nlet lightbox;\nlet images = []; // Массив для хранения URL увеличенных изображений\nlet currentIndex = 0;\n\nsearchForm.addEventListener('submit', async e => {\n  e.preventDefault();\n  searchTerm = searchInput.value.trim();\n  currentPage = 1;\n  currentIndex = 0;\n\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n\n  gallery.innerHTML = '';\n\n  if (searchTerm === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search term.',\n    });\n    loader.style.display = 'none';\n  } else {\n    try {\n      const response = await axios.get(\n        `https://pixabay.com/api/?key=43839854-7e39202c3c35776610ceb4193&q=${searchTerm}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${currentPage}`\n      );\n      images = response.data.hits.map(image => image.largeImageURL); // Заполняем массив URL\n      displayImages(response.data.hits, gallery);\n\n      lightbox = new SimpleLightbox('.simplelightbox a', {\n        elements: '.simplelightbox',\n        closeText: 'Закрыть',\n        docClose: true,\n      });\n\n      if (response.data.totalHits > 15) {\n        loadMoreBtn.style.display = 'block';\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'An error occurred while fetching images. Please try again.',\n      });\n    } finally {\n      loader.style.display = 'none';\n      searchInput.value = '';\n    }\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n\n  loader.style.display = 'block';\n\n  try {\n    const response = await axios.get(\n      `https://pixabay.com/api/?key=43839854-7e39202c3c35776610ceb4193&q=${searchTerm}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${currentPage}`\n    );\n    images = [\n      ...images,\n      ...response.data.hits.map(image => image.largeImageURL),\n    ]; // Дополняем массив URL\n    displayImages(response.data.hits, gallery);\n\n    const cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    lightbox.refresh();\n\n    if (currentPage * 15 >= response.data.totalHits) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching images. Please try again.',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n});\n\ndocument.querySelector('.close-button').addEventListener('click', () => {\n  const modal = document.getElementById('modal');\n  modal.style.display = 'none';\n  window.removeEventListener('keydown', handleKeyDown);\n});\n\ngallery.addEventListener('click', event => {\n  event.preventDefault();\n\n  if (event.target.nodeName === 'IMG') {\n    const largeImageURL = event.target.dataset.largeImage;\n    const modal = document.getElementById('modal');\n    const modalImg = document.getElementById('modal-img');\n    modalImg.src = largeImageURL;\n    modal.style.display = 'block';\n\n    currentIndex = images.indexOf(largeImageURL);\n\n    window.addEventListener('keydown', handleKeyDown);\n  }\n});\n\nfunction handleKeyDown(event) {\n  const modal = document.getElementById('modal');\n  const modalImg = document.getElementById('modal-img');\n\n  if (modal.style.display === 'block') {\n    if (event.key === 'ArrowLeft') {\n      currentIndex = currentIndex > 0 ? currentIndex - 1 : images.length - 1;\n      modalImg.src = images[currentIndex];\n    }\n\n    if (event.key === 'ArrowRight') {\n      currentIndex = currentIndex < images.length - 1 ? currentIndex + 1 : 0;\n      modalImg.src = images[currentIndex];\n    }\n  }\n}\n\ndocument.querySelector('.close-button').addEventListener('click', () => {\n  const modal = document.getElementById('modal');\n  modal.style.display = 'none';\n  window.removeEventListener('keydown', handleKeyDown);\n});\n"],"names":["displayImages","images","gallery","iziToast","imageElements","image","imgElement","card","info","searchForm","searchInput","loader","loadMoreBtn","currentPage","searchTerm","lightbox","currentIndex","e","response","axios","SimpleLightbox","cardHeight","modal","handleKeyDown","event","largeImageURL","modalImg"],"mappings":"owBAEO,SAASA,EAAcC,EAAQC,EAAS,CAC7C,GAAID,EAAO,SAAW,EACpBE,EAAS,MAAM,CACb,MAAO,QACP,QACE,0EACR,CAAK,MACI,CACL,MAAMC,EAAgBH,EAAO,IAAII,GAAS,CACxC,MAAMC,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,IAAMD,EAAM,aACvBC,EAAW,IAAMD,EAAM,KACvBC,EAAW,QAAQ,WAAaD,EAAM,cACtCC,EAAW,QAAQ,MAAQD,EAAM,MACjCC,EAAW,QAAQ,MAAQD,EAAM,MACjCC,EAAW,QAAQ,SAAWD,EAAM,SACpCC,EAAW,QAAQ,UAAYD,EAAM,UAErCC,EAAW,UAAU,IAAI,gBAAgB,EAEzC,MAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,OACjBA,EAAK,YAAYD,CAAU,EAC3B,MAAME,EAAO,SAAS,cAAc,KAAK,EACzC,OAAAA,EAAK,UAAY,OACjBA,EAAK,UAAY;AAAA,oBACHH,EAAM,KAAK;AAAA,oBACXA,EAAM,KAAK;AAAA,uBACRA,EAAM,QAAQ;AAAA,wBACbA,EAAM,SAAS;AAAA,QAEjCE,EAAK,YAAYC,CAAI,EACdD,CACb,CAAK,EAEDL,EAAQ,OAAO,GAAGE,CAAa,CAChC,CACH,CC/BA,MAAMK,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAc,SAAS,eAAe,cAAc,EACpDC,EAAS,SAAS,cAAc,SAAS,EACzCT,EAAU,SAAS,eAAe,SAAS,EAC3CU,EAAc,SAAS,eAAe,eAAe,EAE3D,IAAIC,EAAc,EACdC,EAAa,GACbC,EACAd,EAAS,CAAA,EACTe,EAAe,EAEnBP,EAAW,iBAAiB,SAAU,MAAMQ,GAAK,CAW/C,GAVAA,EAAE,eAAc,EAChBH,EAAaJ,EAAY,MAAM,OAC/BG,EAAc,EACdG,EAAe,EAEfL,EAAO,MAAM,QAAU,QACvBC,EAAY,MAAM,QAAU,OAE5BV,EAAQ,UAAY,GAEhBY,IAAe,GACjBX,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,6BACf,CAAK,EACDQ,EAAO,MAAM,QAAU,WAEvB,IAAI,CACF,MAAMO,EAAW,MAAMC,EAAM,IAC3B,qEAAqEL,CAAU,6EAA6ED,CAAW,EAC/K,EACMZ,EAASiB,EAAS,KAAK,KAAK,IAAIb,GAASA,EAAM,aAAa,EAC5DL,EAAckB,EAAS,KAAK,KAAMhB,CAAO,EAEzCa,EAAW,IAAIK,EAAe,oBAAqB,CACjD,SAAU,kBACV,UAAW,UACX,SAAU,EAClB,CAAO,EAEGF,EAAS,KAAK,UAAY,KAC5BN,EAAY,MAAM,QAAU,QAE/B,MAAe,CACdT,EAAS,MAAM,CACb,MAAO,QACP,QAAS,4DACjB,CAAO,CACP,QAAc,CACRQ,EAAO,MAAM,QAAU,OACvBD,EAAY,MAAQ,EACrB,CAEL,CAAC,EAEDE,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IAEAF,EAAO,MAAM,QAAU,QAEvB,GAAI,CACF,MAAMO,EAAW,MAAMC,EAAM,IAC3B,qEAAqEL,CAAU,6EAA6ED,CAAW,EAC7K,EACIZ,EAAS,CACP,GAAGA,EACH,GAAGiB,EAAS,KAAK,KAAK,IAAIb,GAASA,EAAM,aAAa,CAC5D,EACIL,EAAckB,EAAS,KAAK,KAAMhB,CAAO,EAEzC,MAAMmB,EAAanB,EAAQ,kBAAkB,sBAAqB,EAAG,OAErE,OAAO,SAAS,CACd,IAAKmB,EAAa,EAClB,SAAU,QAChB,CAAK,EAEDN,EAAS,QAAO,EAEZF,EAAc,IAAMK,EAAS,KAAK,YACpCN,EAAY,MAAM,QAAU,OAC5BT,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QAAS,4DACf,CAAK,CACL,QAAY,CACRQ,EAAO,MAAM,QAAU,MACxB,CACH,CAAC,EAED,SAAS,cAAc,eAAe,EAAE,iBAAiB,QAAS,IAAM,CACtE,MAAMW,EAAQ,SAAS,eAAe,OAAO,EAC7CA,EAAM,MAAM,QAAU,OACtB,OAAO,oBAAoB,UAAWC,CAAa,CACrD,CAAC,EAEDrB,EAAQ,iBAAiB,QAASsB,GAAS,CAGzC,GAFAA,EAAM,eAAc,EAEhBA,EAAM,OAAO,WAAa,MAAO,CACnC,MAAMC,EAAgBD,EAAM,OAAO,QAAQ,WACrCF,EAAQ,SAAS,eAAe,OAAO,EACvCI,EAAW,SAAS,eAAe,WAAW,EACpDA,EAAS,IAAMD,EACfH,EAAM,MAAM,QAAU,QAEtBN,EAAef,EAAO,QAAQwB,CAAa,EAE3C,OAAO,iBAAiB,UAAWF,CAAa,CACjD,CACH,CAAC,EAED,SAASA,EAAcC,EAAO,CAC5B,MAAMF,EAAQ,SAAS,eAAe,OAAO,EACvCI,EAAW,SAAS,eAAe,WAAW,EAEhDJ,EAAM,MAAM,UAAY,UACtBE,EAAM,MAAQ,cAChBR,EAAeA,EAAe,EAAIA,EAAe,EAAIf,EAAO,OAAS,EACrEyB,EAAS,IAAMzB,EAAOe,CAAY,GAGhCQ,EAAM,MAAQ,eAChBR,EAAeA,EAAef,EAAO,OAAS,EAAIe,EAAe,EAAI,EACrEU,EAAS,IAAMzB,EAAOe,CAAY,GAGxC,CAEA,SAAS,cAAc,eAAe,EAAE,iBAAiB,QAAS,IAAM,CACtE,MAAMM,EAAQ,SAAS,eAAe,OAAO,EAC7CA,EAAM,MAAM,QAAU,OACtB,OAAO,oBAAoB,UAAWC,CAAa,CACrD,CAAC"}